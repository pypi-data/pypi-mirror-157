# coding: utf-8

"""
    ArcGIS Earth Automation API

    This is an ArcGIS Earth Automation API help page of Swagger. You can find out more about ArcGIS Earth Automation API at https://doc.arcgis.com/en/arcgis-earth/automation-api/get-started.htm  # noqa: E501

    OpenAPI spec version: 1.12-Alpha
    
    Generated by: https://github.com/swagger-api/swagger-codegen.git
"""

from __future__ import absolute_import

import unittest
import json
import time

import swagger_client
from swagger_client.api.flight_api import FlightApi  # noqa: E501
from swagger_client.api.camera_api import CameraApi  # noqa: E501
from swagger_client.rest import ApiException
from test.utils import POSITION_FIELD, TILT_FIELD
from test.utils import is_equal 


class TestFlightApi(unittest.TestCase):
    """FlightApi unit test stubs"""

    def setUp(self):
        self.api = FlightApi()  # noqa: E501
        self.version = "1.0"
        self.flight = {
            "camera":{
                POSITION_FIELD:{
                    "x":-92,
                    "y":41,
                    "z":11000000,
                    "spatialReference":{
                        "wkid":4326
                    }
                },
                "heading":0.0,
                TILT_FIELD:0.099999999996554886
            },
            "duration":2
        }

    def tearDown(self):
        pass

    def test_arcgisearth_flight_post(self):
        """Test case for arcgisearth_flight_post

        Fly-to a target position  # noqa: E501
        """

        response_data, status_code, headers = self.api.arcgisearth_flight_post(
            _preload_content=False,
            async_req=False,
            body=self.flight,
            api_version=self.version)

        self.assertEqual(status_code, 200)
        content = response_data.data
        str_result = content.decode('utf-8')
        self.assertEqual('Success', json.loads(str_result)['result'])

        time.sleep(3)

        camera_api = CameraApi()
        camera, status_code, _ = camera_api.arcgisearth_camera_get(
            async_req=False,
            api_version=self.version)


        self.assertEqual(status_code, 200)

        self.assertTrue(is_equal(camera.position.x, self.flight['camera'][POSITION_FIELD]['x']))
        self.assertTrue(is_equal(camera.position.y, self.flight['camera'][POSITION_FIELD]['y']))
        self.assertTrue(is_equal(camera.position.z, self.flight['camera'][POSITION_FIELD]['z']))


if __name__ == '__main__':
    unittest.main()
