import sqlalchemy
from flask import Blueprint
from flask import render_template
from flask_restx import Api

from statsservice.bootstrap import application
from statsservice.bootstrap import db


api_blueprint = Blueprint("api", __name__, url_prefix="/api/v1")


def setup_api(application):
    authorizations = {
        "apikey": {
            "type": "apiKey",
            "in": "header",
            "name": "X-API-KEY",
        }
    }

    api = Api(
        api_blueprint,
        title="MONARC Stats service - API v1",
        version="1.0",
        description="<a href='https://www.cases.lu' target='_blank' rel='noopener noreferrer'><img src='data:image/png;base64,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' title='CASES.lu' alt='CASES.lu' /></a><br />"  # noqa
        + "API v1 of the MONARC Stats service.<br />"
        + "This is the API used by the <a href='https://www.monarc.lu' target='_blank' rel='noopener noreferrer'>MONARC software</a> for its global dashboard.<br /><br />"  # noqa
        + "Source code: https://github.com/monarc-project/stats-service<br />"
        + "A <a href='https://www.monarc.lu/documentation/stats-service/master/api-v1.html' target='_blank' rel='noopener noreferrer'>documentation is availabe</a> with some examples.<br /><br />"  # noqa
        + "Responsible of this instance: "
        + application.config["ADMIN_EMAIL"],
        license="GNU Affero General Public License version 3",
        license_url="https://www.gnu.org/licenses/agpl-3.0.html",
        doc="/",
        security="apikey",
        authorizations=authorizations,
        contact_email=application.config["ADMIN_EMAIL"],
        contact_url=application.config["ADMIN_URL"],
    )

    @api.errorhandler(sqlalchemy.exc.IntegrityError)
    def handle_duplicate_object_exception(error):
        """Return a 304 status code on SQLALchemy IntegrityError."""
        db.session.rollback()
        return {"message": "Duplicate object."}, 304

    @api.documentation
    def custom_ui():
        return render_template(
            "swagger-ui.html",
            title=api.title,
            specs_url="{}/api/v1/swagger.json".format(
                application.config["INSTANCE_URL"]
            ),
        )

    from statsservice.api.v1 import stats, client, processed

    api.add_namespace(client.client_ns, path="/client")
    api.add_namespace(stats.stats_ns, path="/stats")
    api.add_namespace(processed.processed_ns, path="/stats/processed")

    return api


api = setup_api(application)
