"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[584],{2584:function(e,n,t){t.r(n),t.d(n,{default:function(){return p}});var r=t(841),i=t(3777),s=t(5847),a=t(9596),l=t(7313),c=t(6629),d=t(9234),o=t(4033),x=t(2954),h=t(6170),u="var(--chakra-colors-blue-300)";var j=t(1904),m=t(6417);function p(e){var n=e.source,t=e.data,a=e.reportName;if((0,j.j)(a),!t)return(0,m.jsx)(d.o,{children:(0,m.jsx)(r.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})});var l=(0,x.c6)(null===t||void 0===t?void 0:t.assertion_results);return(0,m.jsx)(d.o,{alignItems:"flex-start",children:(0,m.jsxs)(r.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,m.jsx)(r.kC,{mx:"10%",mt:4,children:(0,m.jsxs)(i.aG,{fontSize:"lg",children:[(0,m.jsx)(i.gN,{children:(0,m.jsx)(c.rU,{href:"/",children:(0,m.jsx)(i.At,{href:"/",children:n.name})})}),(0,m.jsx)(i.gN,{isCurrentPage:!0,children:(0,m.jsx)(i.At,{href:"#",children:t.name})})]})}),(0,m.jsxs)(r.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,m.jsxs)(r.kC,{direction:"column",gap:4,mb:8,children:[(0,m.jsx)(r.X6,{size:"lg",children:"Overview"}),(0,m.jsxs)(r.xv,{children:["Table:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:t.name})]}),(0,m.jsxs)(r.xv,{children:["Rows:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:(0,x.uf)(t.row_count)})]}),(0,m.jsxs)(r.xv,{children:["Columns:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:(0,x.uf)(t.col_count)})]}),(0,m.jsxs)(r.xv,{children:["Test Status:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:l.passed})," ","Passed,"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,color:l.failed>0?"red.500":"inherit",children:l.failed})," ","Failed"]})]}),(0,m.jsxs)(s.mQ,{isLazy:!0,children:[(0,m.jsxs)(s.td,{children:[(0,m.jsx)(s.OK,{children:"Profiling"}),(0,m.jsx)(s.OK,{children:"Tests"})]}),(0,m.jsxs)(s.nP,{children:[(0,m.jsx)(s.x4,{children:(0,m.jsx)(f,{data:t.columns})}),(0,m.jsx)(s.x4,{children:(0,m.jsx)(v,{tableName:t.name,data:t.assertion_results})})]})]})]})]})})}function f(e){var n=e.data;return(0,m.jsx)(r.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e],i=t.distribution,s=t.non_nulls===t.total;return(0,m.jsxs)(r.kC,{direction:"column",px:4,children:[(0,m.jsxs)(r.rj,{my:4,templateColumns:"450px 1fr",gap:4,children:[(0,m.jsxs)(r.kC,{direction:"column",gap:3,children:[(0,m.jsxs)(r.xv,{children:[(0,m.jsx)(r.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,children:t.name}),"","(",(0,m.jsx)(r.EK,{children:t.schema_type}),")"]}),(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Total",base:(0,x.uf)(t.total)}),(0,m.jsx)(o.$,{name:"Missing",base:(0,m.jsx)(r.xv,{as:"span",color:s?"green.500":"red.500",children:s?"0%":(0,x.ro)(t)})}),(0,m.jsx)(o.$,{name:"Distinct",base:(0,x.uf)(t.distinct)})]}),("numeric"===t.type||"integer"===t.type)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Average",base:(0,x.uf)(t.avg)}),(0,m.jsx)(o.$,{name:"Std. Deviation",base:(0,x.uf)(t.stddev)})]}),(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Min",base:(0,x.uf)(t.min)}),(0,m.jsx)(o.$,{name:"5%",base:(0,x.uf)(t.p5)}),(0,m.jsx)(o.$,{name:"25%",base:(0,x.uf)(t.p25)}),(0,m.jsx)(o.$,{name:"50%",base:(0,x.uf)(t.p50)}),(0,m.jsx)(o.$,{name:"75%",base:(0,x.uf)(t.p75)}),(0,m.jsx)(o.$,{name:"95%",base:(0,x.uf)(t.p95)}),(0,m.jsx)(o.$,{name:"Max",base:(0,x.uf)(t.max)})]})]}),"datetime"===t.type&&(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Min",base:t.min}),(0,m.jsx)(o.$,{name:"Max",base:t.max})]})]}),(0,m.jsx)(r.kC,{mt:8,justifyContent:"center",alignItems:"flex-start",children:i?(0,m.jsx)(g,{data:i.labels.map((function(e,n){return{label:e,value:i.counts[n],total:t.total}}))}):(0,m.jsx)(r.xv,{children:"No data available"})})]}),(0,m.jsx)(r.iz,{my:4})]},e)}))})}function v(e){e.tableName;var n=e.data,t=null===n||void 0===n?void 0:n.tests,i=null===n||void 0===n?void 0:n.columns;return 0===t.length&&0===Object.keys(i).length?(0,m.jsx)(r.kC,{direction:"column",children:(0,m.jsx)(r.xv,{textAlign:"center",children:"No tests available"})}):(0,m.jsx)(r.kC,{direction:"column",gap:4,children:(0,m.jsx)(a.xJ,{children:(0,m.jsxs)(a.iA,{variant:"simple",children:[(0,m.jsx)(a.hr,{children:(0,m.jsxs)(a.Tr,{children:[(0,m.jsx)(a.Th,{children:"Level"}),(0,m.jsx)(a.Th,{children:"Column"}),(0,m.jsx)(a.Th,{children:"Status"}),(0,m.jsx)(a.Th,{children:"Assertion"}),(0,m.jsx)(a.Th,{children:"Expected"}),(0,m.jsx)(a.Th,{children:"Actual"})]})}),(0,m.jsxs)(a.p3,{children:[t.map((function(e){var n="failed"===e.status;return(0,m.jsxs)(a.Tr,{children:[(0,m.jsx)(a.Td,{children:"Table"}),(0,m.jsx)(a.Td,{children:"-"}),(0,m.jsx)(a.Td,{children:n?(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"}):(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"})}),(0,m.jsx)(a.Td,{children:e.name}),(0,m.jsx)(a.Td,{children:(0,x.aH)(e.expected)}),(0,m.jsx)(a.Td,{color:n&&"red.500",children:(0,x.aH)(e.actual)})]},e.name)})),Object.keys(i).map((function(e){return i[e].map((function(n){var t="failed"===n.status;return(0,m.jsxs)(a.Tr,{children:[(0,m.jsx)(a.Td,{children:"Column"}),(0,m.jsx)(a.Td,{children:e}),(0,m.jsx)(a.Td,{children:t?(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"}):(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"})}),(0,m.jsx)(a.Td,{children:n.name}),(0,m.jsx)(a.Td,{children:(0,x.aH)(n.expected)}),(0,m.jsx)(a.Td,{color:t&&"red.500",children:(0,x.aH)(n.actual)})]},n.name)}))}))]})]})})})}function g(e){var n=e.data,t=(0,l.useRef)(null),i=(0,l.useRef)(null);return(0,l.useEffect)((function(){n.length>0&&function(e){var n=e.containerWidth,t=e.containerHeight,r=e.svgTarget,i=e.tooltipTarget,s=e.data,a=10,l=30,c=30,d=50,o=n-d-l,j=t-a-c,m=h.Ys(r);m.selectAll("*").remove();var p=m.attr("width",o+d+l).attr("height",j+a+c).append("g").attr("transform","translate(".concat(d,",").concat(a,")")),f=(0,x.vy)({target:i}),v=h.tiA().domain(s.map((function(e){return e.label}))).range([0,o]).padding(.5),g=h.BYU().domain([0,h.Fp7(s,(function(e){return e.value}))]).range([j,0]);p.append("g").attr("transform","translate(0, ".concat(j,")")).call(h.LLu(v).tickFormat((function(e,n){var t=v.domain().length-1;return 0===n||n===t/2||n===t?e:null}))),p.append("g").call(h.y4O(g).tickFormat((function(e){return"".concat(e)})).ticks(8)),p.selectAll().data(s).enter().append("rect").style("opacity",0).attr("class","overlay-bars").attr("x",(function(e){return v(e.label)-5})).attr("y",(function(e){return 0})).attr("width",v.bandwidth()+10).attr("height",(function(e){return j})).on("mouseover",(function(e,n){f.html("\n          <div>\n            <p>Label: ".concat(n.label,"</p>\n            <p>Count: ").concat((0,x.uf)(n.value),"</p>\n            <p>Percentage: ").concat(Number(n.value/n.total*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),h.Ys(this).style("fill",u).style("opacity",.3)})).on("mousemove",(function(e){f.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){f.html("").transition().duration(500).style("visibility","hidden"),h.Ys(this).style("opacity",0)})),p.selectAll().data(s).enter().append("rect").attr("x",(function(e){return v(e.label)})).attr("y",(function(e){return g(e.value)})).attr("height",(function(e){return j-g(e.value)})).attr("width",v.bandwidth()).style("fill",u)}({containerWidth:i.current.getBoundingClientRect().width,containerHeight:i.current.getBoundingClientRect().height,svgTarget:t.current,tooltipTarget:".chart",data:n})}),[n]),(0,m.jsx)(r.kC,{className:"chart",width:"100%",ref:i,children:(0,m.jsx)("svg",{ref:t})})}},4033:function(e,n,t){t.d(n,{$:function(){return s}});var r=t(841),i=t(6417);function s(e){var n=e.name,t=e.base,s=e.input,a=void 0===s?null:s;return(0,i.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,i.jsx)(r.xv,{fontWeight:700,children:n}),(0,i.jsxs)(r.kC,{gap:8,children:[(0,i.jsx)(r.xv,{textAlign:"right",width:"100px",children:t}),a&&(0,i.jsx)(r.xv,{textAlign:"right",width:"100px",children:a})]})]})}}}]);