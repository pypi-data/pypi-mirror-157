"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[974],{6974:function(e,n,t){t.r(n),t.d(n,{default:function(){return f}});var r=t(8470),i=t(3929),s=t(3793),a=t(1659),l=t(3609),c=t(964),d=t(9922),o=t(8279),x=t(2244),h=t(6934),u=t(9270),j=t(3133);var m=t(4197);function f(e){var n=e.source,t=e.data,a=e.reportName;if((0,h.j)(a),!t)return(0,m.jsx)(d.o,{children:(0,m.jsx)(r.kC,{justifyContent:"center",alignItems:"center",minHeight:"100vh",children:"No profile data found."})});var l=(0,x.c6)(null===t||void 0===t?void 0:t.assertion_results);return(0,m.jsx)(d.o,{alignItems:"flex-start",children:(0,m.jsxs)(r.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,m.jsx)(r.kC,{mx:"10%",mt:4,children:(0,m.jsxs)(i.aG,{fontSize:"lg",children:[(0,m.jsx)(i.gN,{children:(0,m.jsx)(c.rU,{href:"/",children:(0,m.jsx)(i.At,{href:"/",children:n.name})})}),(0,m.jsx)(i.gN,{isCurrentPage:!0,children:(0,m.jsx)(i.At,{href:"#",children:t.name})})]})}),(0,m.jsxs)(r.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",children:[(0,m.jsxs)(r.kC,{direction:"column",gap:4,mb:8,children:[(0,m.jsx)(r.X6,{size:"lg",children:"Overview"}),(0,m.jsxs)(r.xv,{children:["Table:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:t.name})]}),(0,m.jsxs)(r.xv,{children:["Rows:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:(0,x.uf)(t.row_count)})]}),(0,m.jsxs)(r.xv,{children:["Columns:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:(0,x.uf)(t.col_count)})]}),(0,m.jsxs)(r.xv,{children:["Test Status:"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,children:l.passed})," ","Passed,"," ",(0,m.jsx)(r.xv,{as:"span",fontWeight:700,color:l.failed>0?"red.500":"inherit",children:l.failed})," ","Failed"]})]}),(0,m.jsxs)(s.mQ,{isLazy:!0,children:[(0,m.jsxs)(s.td,{children:[(0,m.jsx)(s.OK,{children:"Profiling"}),(0,m.jsx)(s.OK,{children:"Tests"})]}),(0,m.jsxs)(s.nP,{children:[(0,m.jsx)(s.x4,{children:(0,m.jsx)(v,{data:t.columns})}),(0,m.jsx)(s.x4,{children:(0,m.jsx)(p,{data:t.assertion_results})})]})]})]})]})})}function v(e){var n=e.data;return(0,m.jsx)(r.kC,{direction:"column",gap:4,children:Object.keys(n).map((function(e){var t=n[e],i=t.distribution,s=t.non_nulls===t.total;return(0,m.jsxs)(r.kC,{direction:"column",px:4,children:[(0,m.jsxs)(r.rj,{my:4,templateColumns:"minmax(270px, 1fr) 1fr",gap:12,children:[(0,m.jsxs)(r.kC,{direction:"column",gap:3,children:[(0,m.jsxs)(r.xv,{maxWidth:"100%",children:[(0,m.jsx)(r.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,title:t.name,noOfLines:1,children:t.name}),"","(",(0,m.jsx)(r.EK,{children:t.schema_type}),")"]}),(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Total",base:(0,x.uf)(t.total)}),(0,m.jsx)(o.$,{name:"Missing",base:(0,m.jsx)(r.xv,{as:"span",color:s?"green.500":"red.500",children:s?"0%":(0,x.ro)(t)})}),(0,m.jsx)(o.$,{name:"Distinct",base:(0,x.uf)(t.distinct)})]}),"numeric"===t.type&&(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Min",base:(0,x.uf)(t.min)}),(0,m.jsx)(o.$,{name:"Max",base:(0,x.uf)(t.max)}),(0,m.jsx)(o.$,{name:"Avg",base:(0,x.uf)(t.avg)})]}),"datetime"===t.type&&(0,m.jsxs)(r.kC,{direction:"column",children:[(0,m.jsx)(o.$,{name:"Min",base:t.min}),(0,m.jsx)(o.$,{name:"Max",base:t.max})]})]}),(0,m.jsx)(r.kC,{mt:12,width:"100%",justifyContent:"center",alignItems:"stretch",children:i?(0,m.jsx)(g,{data:i.labels.map((function(e,n){return{label:e,value:i.counts[n],total:t.total}}))}):(0,m.jsx)(r.xv,{children:"No data available"})})]}),(0,m.jsx)(r.iz,{my:4})]},e)}))})}function p(e){var n=e.data,t=null===n||void 0===n?void 0:n.tests,i=null===n||void 0===n?void 0:n.columns;return 0===t.length&&0===Object.keys(i).length?(0,m.jsx)(r.kC,{direction:"column",children:(0,m.jsx)(r.xv,{textAlign:"center",children:"No tests available"})}):(0,m.jsx)(r.kC,{direction:"column",gap:4,children:(0,m.jsx)(a.xJ,{children:(0,m.jsxs)(a.iA,{variant:"simple",children:[(0,m.jsx)(a.hr,{children:(0,m.jsxs)(a.Tr,{children:[(0,m.jsx)(a.Th,{children:"Level"}),(0,m.jsx)(a.Th,{children:"Column"}),(0,m.jsx)(a.Th,{children:"Status"}),(0,m.jsx)(a.Th,{children:"Assertion"}),(0,m.jsx)(a.Th,{children:"Expected"}),(0,m.jsx)(a.Th,{children:"Actual"})]})}),(0,m.jsxs)(a.p3,{children:[t.map((function(e){var n="failed"===e.status;return(0,m.jsxs)(a.Tr,{children:[(0,m.jsx)(a.Td,{children:"Table"}),(0,m.jsx)(a.Td,{children:"-"}),(0,m.jsx)(a.Td,{children:n?(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"}):(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"})}),(0,m.jsx)(a.Td,{children:e.name}),(0,m.jsx)(a.Td,{children:(0,x.aH)(e.expected)}),(0,m.jsx)(a.Td,{color:n?"red.500":"inherit",children:(0,x.aH)(e.actual)})]},e.name)})),Object.keys(i).map((function(e){return i[e].map((function(n){var t="failed"===n.status;return(0,m.jsxs)(a.Tr,{children:[(0,m.jsx)(a.Td,{children:"Column"}),(0,m.jsx)(a.Td,{children:e}),(0,m.jsx)(a.Td,{children:t?(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"}):(0,m.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"})}),(0,m.jsx)(a.Td,{children:n.name}),(0,m.jsx)(a.Td,{children:(0,x.aH)(n.expected)}),(0,m.jsx)(a.Td,{color:t?"red.500":"inherit",children:(0,x.aH)(n.actual)})]},n.name)}))}))]})]})})})}function g(e){var n=e.data,t=(0,l.useRef)(null),i=(0,l.useRef)(null);return function(e){var n=e.target,t=e.data,r=e.dimensions;(0,l.useEffect)((function(){if(n&&r&&t){var e=j.Ys(n.current),i=j.tiA().domain(t.map((function(e){return e.label}))).range([0,r.width]).padding(.05),s=j.LLu(i).tickFormat((function(e,n){var t=i.domain().length-1;return 0===n||n===t/2||n===t?e:null}));e.select(".x-axis").style("transform","translateY(".concat(r.height,"px)")).call(s);var a=j.BYU().domain([0,j.Fp7(t,(function(e){return e.value}))]).range([r.height,0]),l=j.y4O(a);e.select(".y-axis").call(l),e.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",(function(e){return i(e.label)})).attr("y",(function(e){return a(e.value)})).attr("width",i.bandwidth()).attr("height",(function(e){return r.height-a(e.value)})).style("fill","var(--chakra-colors-blue-300)");var c=(0,x.vy)({target:".chart"});return e.selectAll(".overlay-bars").data(t).join("rect").attr("class","overlay-bars").attr("x",(function(e){return i(e.label)})).attr("y",(function(){return 0})).attr("width",i.bandwidth()).attr("height",(function(){return r.height})).style("opacity",0).on("mouseover",(function(e,n){var t=n,r=t.label,i=t.value,s=t.total;c.html("\n          <div>\n            <p>Label: ".concat(r,"</p>\n            <p>Count: ").concat((0,x.uf)(i),"</p>\n            <p>Percentage: ").concat(Number(i/s*100).toFixed(3),"%</p>\n          </div>\n        ")).transition().duration(500).style("visibility","visible"),j.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){c.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){c.html("").transition().duration(500).style("visibility","hidden"),j.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[n,r,t])}({target:t,data:n,dimensions:(0,u.y)(i)}),(0,m.jsx)(r.kC,{className:"chart",width:"100%",ref:i,children:(0,m.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,m.jsx)("g",{className:"x-axis"}),(0,m.jsx)("g",{className:"y-axis"})]})})}},8279:function(e,n,t){t.d(n,{$:function(){return s}});var r=t(8470),i=t(4197);function s(e){var n=e.name,t=e.base,s=e.input,a=void 0===s?null:s;return(0,i.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,i.jsx)(r.xv,{fontWeight:700,children:n}),(0,i.jsxs)(r.kC,{gap:8,children:[(0,i.jsx)(r.xv,{textAlign:"right",width:"100px",children:t}),a&&(0,i.jsx)(r.xv,{textAlign:"right",width:"100px",children:a})]})]})}},9270:function(e,n,t){t.d(n,{y:function(){return s}});var r=t(8951),i=t(3609);function s(e){var n=(0,i.useState)(null),t=(0,r.Z)(n,2),s=t[0],a=t[1];return(0,i.useEffect)((function(){if(e&&e.current){var n=e.current,t=new ResizeObserver((function(e){e.forEach((function(e){a(e.contentRect)}))}));return t.observe(n),function(){t.unobserve(n)}}}),[e]),s}}}]);