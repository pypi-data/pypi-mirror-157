"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[599],{2599:function(n,i,e){e.r(i),e.d(i,{default:function(){return Z}});var l=e(1413),s=e(885),d=e(2982),t=e(5987),r=e(841),c=e(9596),a=e(4153),o=e(3777),u=e(5847),x=e(7482),h=e(6629),j=e(2751),v=e(7313),p=e(9522),m=e.n(p),f=e(9234),g=e(4033),b=e(2954),T=e(1556),C=e(1904),y=e(6106),k=e(6417),w=["base","input"];function A(n){switch(n.status){case"passed":return(0,k.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,k.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,k.jsx)(r.xv,{as:"span",role:"img",children:"-"})}}function _(n){var i=n.base,e=void 0===i?[]:i,l=n.input,s=void 0===l?[]:l,a=(0,t.Z)(n,w),o=m()([].concat((0,d.Z)(e),(0,d.Z)(s)),(function(n){return"".concat(n.level,"_").concat(n.column,"_").concat(n.name)})),u=Object.values(o).map((function(n){var i={level:n[0].level,column:n[0].column,name:n[0].name};return n.forEach((function(n){"base"===n.from?i.base=n:i.input=n})),i}));return 0===u.length?(0,k.jsx)(r.kC,{direction:"column",children:(0,k.jsx)(r.xv,{textAlign:"center",children:"No tests available"})}):(0,k.jsx)(c.xJ,{children:(0,k.jsxs)(c.iA,{variant:"simple",children:[(0,k.jsx)(c.hr,{children:(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Th,{children:"Level"}),(0,k.jsx)(c.Th,{children:"Column"}),(0,k.jsx)(c.Th,{children:"Assertion"}),(0,k.jsx)(c.Th,{children:"Base Status"}),(0,k.jsx)(c.Th,{children:"Input Status"}),(0,k.jsx)(c.Th,{})]})}),(0,k.jsx)(c.p3,{children:Object.values(u).map((function(n){var i,e;return(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{children:n.level}),(0,k.jsx)(c.Td,{children:n.column}),(0,k.jsx)(c.Td,{children:n.name}),(0,k.jsx)(c.Td,{children:(0,k.jsx)(A,{status:null===(i=n.base)||void 0===i?void 0:i.status})}),(0,k.jsx)(c.Td,{children:(0,k.jsx)(A,{status:null===(e=n.input)||void 0===e?void 0:e.status})}),(0,k.jsx)(c.Td,{onClick:function(){return null===a||void 0===a?void 0:a.onDetailVisible(n)},children:(0,k.jsx)(r.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,j.x0)())}))})]})})}function $(n){var i=n.base,e=n.input,d=[],t={},a=0,o=0,u=0,x=0;return Object.entries((null===i||void 0===i?void 0:i.columns)||[]).forEach((function(n){var i=(0,s.Z)(n,2),e=i[0],l=i[1];t[l.name]=a,d.push({name:e,changed:!0,base:l,input:void 0}),a++,u++})),Object.entries((null===e||void 0===e?void 0:e.columns)||[]).forEach((function(n){var i=(0,s.Z)(n,2),e=i[0],r=i[1];if(t.hasOwnProperty(r.name)){var c=t[r.name],a=d[c].base.schema_type!==r.schema_type;d[c]=(0,l.Z)((0,l.Z)({},d[c]),{},{input:r,changed:a}),u--,a&&x++}else d.push({name:e,changed:!0,base:void 0,input:r}),o++})),(0,k.jsxs)(r.kC,{direction:"column",children:[(0,k.jsxs)(r.xv,{mb:4,p:2,children:["Added:",(0,k.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:o}),", Deleted:",(0,k.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:u}),", Changed:"," ",(0,k.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:x})]}),(0,k.jsxs)(r.kC,{justifyContent:"space-evenly",children:[(0,k.jsx)(c.xJ,{width:"50%",children:(0,k.jsxs)(c.iA,{variant:"simple",children:[(0,k.jsx)(c.hr,{children:(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Th,{children:"Column"}),(0,k.jsx)(c.Th,{children:"Type"})]})}),(0,k.jsx)(c.p3,{children:d.map((function(n){var i,e,l,s;return(0,k.jsxs)(c.Tr,{color:n.changed?"red.500":"inherit",children:[(0,k.jsx)(c.Td,{children:null!==(i=null===(e=n.base)||void 0===e?void 0:e.name)&&void 0!==i?i:"-"}),(0,k.jsx)(c.Td,{children:null!==(l=null===(s=n.base)||void 0===s?void 0:s.schema_type)&&void 0!==l?l:"-"})]},(0,j.x0)(10))}))})]})}),(0,k.jsx)(r.kC,{justifyContent:"center",children:(0,k.jsx)(r.iz,{orientation:"vertical"})}),(0,k.jsx)(c.xJ,{width:"50%",children:(0,k.jsxs)(c.iA,{variant:"simple",children:[(0,k.jsx)(c.hr,{children:(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Th,{children:"Column"}),(0,k.jsx)(c.Th,{children:"Value"})]})}),(0,k.jsx)(c.p3,{children:d.map((function(n){var i,e,l,s;return(0,k.jsxs)(c.Tr,{color:n.changed?"red.500":"inherit",children:[(0,k.jsx)(c.Td,{children:null!==(i=null===(e=n.input)||void 0===e?void 0:e.name)&&void 0!==i?i:"-"}),(0,k.jsx)(c.Td,{children:null!==(l=null===(s=n.input)||void 0===s?void 0:s.schema_type)&&void 0!==l?l:"-"})]},(0,j.x0)(10))}))})]})})]})]})}function W(n){var i,e,l,d,t=n.name,c=n.base,a=n.input,o=c||a,u=(0,v.useState)([]),x=(0,s.Z)(u,2),h=x[0],j=x[1];return(0,v.useEffect)((function(){if((null===c||void 0===c?void 0:c.type)!==(null===a||void 0===a?void 0:a.type)||"string"!==(null===c||void 0===c?void 0:c.type)&&"datetime"!==(null===c||void 0===c?void 0:c.type)){var n=c?(0,T.rg)({base:c.distribution.counts,input:null,labels:c.distribution.labels}):null,i=a?(0,T.rg)({base:a.distribution.counts,input:null,labels:a.distribution.labels}):null;j([n,i])}else{var e=(0,T.Uu)({base:c.distribution,input:a.distribution});j([e])}}),[c,a]),(0,k.jsx)(r.kC,{direction:"column",children:(0,k.jsxs)(r.rj,{my:4,templateColumns:"500px 1fr",gap:3,children:[(0,k.jsx)(r.kC,{direction:"column",gap:2,minH:"250px",children:(0,k.jsxs)(r.kC,{direction:"column",gap:3,children:[(0,k.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,k.jsxs)(r.xv,{children:[(0,k.jsx)(r.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,children:o.name}),"","(",(0,k.jsx)(r.EK,{children:o.schema_type}),")"]}),(0,k.jsxs)(r.kC,{gap:8,children:[(0,k.jsx)(r.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,k.jsx)(r.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Input"})]})]}),(0,k.jsxs)(r.kC,{direction:"column",children:[(0,k.jsx)(g.$,{name:"Total",base:null!==c&&void 0!==c&&c.total?(0,b.uf)(null===c||void 0===c?void 0:c.total):"-",input:null!==a&&void 0!==a&&a.total?(0,b.uf)(null===a||void 0===a?void 0:a.total):"-"}),(0,k.jsx)(g.$,{name:"Missing",base:(0,b.ro)(c),input:(0,b.ro)(a)}),(0,k.jsx)(g.$,{name:"Distinct",base:null!==c&&void 0!==c&&c.distinct?(0,b.uf)(c.distinct):"-",input:null!==a&&void 0!==a&&a.distinct?(0,b.uf)(a.distinct):"-"})]}),("numeric"===o.type||"integer"===o.type)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(r.kC,{direction:"column",children:[(0,k.jsx)(g.$,{name:"Average",base:null!==c&&void 0!==c&&c.avg?(0,b.uf)(c.avg):"-",input:null!==a&&void 0!==a&&a.avg?(0,b.uf)(a.avg):"-"}),(0,k.jsx)(g.$,{name:"Std. Deviation",base:null!==c&&void 0!==c&&c.stddev?(0,b.uf)(c.stddev):"-",input:null!==a&&void 0!==a&&a.stddev?(0,b.uf)(a.stddev):"-"})]}),(0,k.jsxs)(r.kC,{direction:"column",children:[(0,k.jsx)(g.$,{name:"Min",base:null!==c&&void 0!==c&&c.min?(0,b.uf)(c.min):"-",input:null!==a&&void 0!==a&&a.min?(0,b.uf)(a.min):"-"}),(0,k.jsx)(g.$,{name:"5%",base:null!==c&&void 0!==c&&c.p5?(0,b.uf)(c.p5):"-",input:null!==a&&void 0!==a&&a.p5?(0,b.uf)(a.p5):"-"}),(0,k.jsx)(g.$,{name:"25%",base:null!==c&&void 0!==c&&c.p25?(0,b.uf)(c.p25):"-",input:null!==a&&void 0!==a&&a.p25?(0,b.uf)(a.p25):"-"}),(0,k.jsx)(g.$,{name:"50%",base:null!==c&&void 0!==c&&c.p50?(0,b.uf)(c.p50):"-",input:null!==a&&void 0!==a&&a.p50?(0,b.uf)(a.p50):"-"}),(0,k.jsx)(g.$,{name:"75%",base:null!==c&&void 0!==c&&c.p75?(0,b.uf)(c.p75):"-",input:null!==a&&void 0!==a&&a.p75?(0,b.uf)(a.p75):"-"}),(0,k.jsx)(g.$,{name:"95%",base:null!==c&&void 0!==c&&c.p95?(0,b.uf)(c.p95):"-",input:null!==a&&void 0!==a&&a.p95?(0,b.uf)(a.p95):"-"}),(0,k.jsx)(g.$,{name:"Max",base:null!==c&&void 0!==c&&c.max?(0,b.uf)(c.max):"-",input:null!==a&&void 0!==a&&a.max?(0,b.uf)(a.max):"-"})]})]}),"datetime"===o.type&&(0,k.jsxs)(r.kC,{direction:"column",children:[(0,k.jsx)(g.$,{name:"Min",base:null!==(i=null===c||void 0===c?void 0:c.min)&&void 0!==i?i:"-",input:null!==(e=null===a||void 0===a?void 0:a.min)&&void 0!==e?e:"-"}),(0,k.jsx)(g.$,{name:"Max",base:null!==(l=null===c||void 0===c?void 0:c.max)&&void 0!==l?l:"-",input:null!==(d=null===a||void 0===a?void 0:a.max)&&void 0!==d?d:"-"})]})]})}),1===h.length&&(0,k.jsx)(S,{data:h[0]}),2===h.length&&(0,k.jsxs)(r.rj,{my:4,templateColumns:"1fr 1fr",gap:3,children:[h[0]?(0,k.jsx)(S,{data:h[0]}):(0,k.jsx)(r.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"}),h[1]?(0,k.jsx)(S,{data:h[1]}):(0,k.jsx)(r.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})]})]})},t)}function O(n){var i=n.base,e=n.input,l=(0,T.yl)(null===i||void 0===i?void 0:i.columns,null===e||void 0===e?void 0:e.columns);return(0,k.jsx)(k.Fragment,{children:Object.entries(l).map((function(n){var i=(0,s.Z)(n,2),e=i[0],l=i[1];return(0,k.jsx)(W,{name:e,base:l.base,input:l.input},e)}))})}function Z(n){var i,e,l,d,t,j,p=n.base,m=n.input,g=n.reportName,w=(0,T.mT)(null===p||void 0===p?void 0:p.assertion_results,"base"),W=(0,T.mT)(null===m||void 0===m?void 0:m.assertion_results,"input"),Z=(0,a.qY)(),S=Z.isOpen,z=Z.onOpen,B=Z.onClose,E=(0,v.useState)(null),H=(0,s.Z)(E,2),N=H[0],I=H[1];return(0,C.j)(g),(0,k.jsxs)(f.o,{children:[(0,k.jsxs)(r.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,k.jsx)(r.kC,{mx:"10%",mt:4,children:(0,k.jsxs)(o.aG,{fontSize:"lg",children:[(0,k.jsx)(o.gN,{children:(0,k.jsx)(h.rU,{href:"/",children:(0,k.jsx)(o.At,{href:"/",children:"Tables"})})}),(0,k.jsx)(o.gN,{isCurrentPage:!0,children:(0,k.jsx)(o.At,{href:"#",children:g})})]})}),(0,k.jsxs)(r.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",gap:8,children:[(0,k.jsx)(r.X6,{fontSize:24,children:"Overview"}),(0,k.jsx)(c.xJ,{children:(0,k.jsxs)(c.iA,{variant:"simple",children:[(0,k.jsx)(c.hr,{children:(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Th,{width:"10%"}),(0,k.jsx)(c.Th,{width:"45%",children:"Base"}),(0,k.jsx)(c.Th,{width:"45%",children:"Input"})]})}),(0,k.jsxs)(c.p3,{children:[(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{children:"Table"}),(0,k.jsx)(c.Td,{children:null!==(i=null===p||void 0===p?void 0:p.name)&&void 0!==i?i:"-"}),(0,k.jsx)(c.Td,{children:null!==(e=null===m||void 0===m?void 0:m.name)&&void 0!==e?e:"-"})]}),(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{children:"Rows"}),(0,k.jsx)(c.Td,{children:null!==(l=null===p||void 0===p?void 0:p.row_count)&&void 0!==l?l:"-"}),(0,k.jsx)(c.Td,{children:null!==(d=null===m||void 0===m?void 0:m.row_count)&&void 0!==d?d:"-"})]}),(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{children:"Columns"}),(0,k.jsx)(c.Td,{children:null!==(t=null===p||void 0===p?void 0:p.col_count)&&void 0!==t?t:"-"}),(0,k.jsx)(c.Td,{children:null!==(j=null===m||void 0===m?void 0:m.col_count)&&void 0!==j?j:"-"})]}),(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{children:"Test status"}),(0,k.jsx)(c.Td,{children:(0,k.jsxs)(r.xv,{children:[(0,k.jsxs)(r.xv,{as:"span",fontWeight:700,children:[w.passed," "]}),"Passed",", ",(0,k.jsxs)(r.xv,{as:"span",fontWeight:700,color:w.failed>0?"red.500":"inherit",children:[w.failed," "]}),"Failed"]})}),(0,k.jsx)(c.Td,{children:(0,k.jsxs)(r.xv,{children:[(0,k.jsxs)(r.xv,{as:"span",fontWeight:700,children:[W.passed," "]}),"Passed",", ",(0,k.jsxs)(r.xv,{as:"span",fontWeight:700,color:W.failed>0?"red.500":"inherit",children:[W.failed," "]}),"Failed"]})})]})]})]})}),(0,k.jsxs)(u.mQ,{isLazy:!0,children:[(0,k.jsxs)(u.td,{children:[(0,k.jsx)(u.OK,{children:"Schema"}),(0,k.jsx)(u.OK,{children:"Profiling"}),(0,k.jsx)(u.OK,{children:"Tests"})]}),(0,k.jsxs)(u.nP,{children:[(0,k.jsx)(u.x4,{children:(0,k.jsx)($,{base:p,input:m})}),(0,k.jsx)(u.x4,{children:(0,k.jsx)(O,{base:p,input:m})}),(0,k.jsx)(u.x4,{children:(0,k.jsx)(_,{base:null===w||void 0===w?void 0:w.tests,input:null===W||void 0===W?void 0:W.tests,onDetailVisible:function(n){I(n),z()}})})]})]})]})]}),(0,k.jsxs)(x.u_,{isOpen:S,size:"2xl",onClose:function(){B(),I(null)},children:[(0,k.jsx)(x.ZA,{}),(0,k.jsxs)(x.hz,{children:[(0,k.jsx)(x.xB,{children:null===N||void 0===N?void 0:N.name}),(0,k.jsx)(x.ol,{}),(0,k.jsx)(x.fe,{children:(0,k.jsx)(c.xJ,{children:(0,k.jsxs)(c.iA,{variant:"simple",children:[(0,k.jsx)(c.hr,{children:(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Th,{}),(0,k.jsx)(c.Th,{children:"Status"}),(0,k.jsx)(c.Th,{children:"Expected"}),(0,k.jsx)(c.Th,{children:"Actual"})]})}),(0,k.jsxs)(c.p3,{children:[(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{fontWeight:700,children:"Base"}),(0,k.jsx)(c.Td,{children:(0,k.jsx)(A,{status:null===N||void 0===N?void 0:N.base.status})}),(0,k.jsx)(c.Td,{children:(0,b.aH)(null===N||void 0===N?void 0:N.base.expected)}),(0,k.jsx)(c.Td,{children:(0,b.aH)(null===N||void 0===N?void 0:N.base.actual)})]}),(0,k.jsxs)(c.Tr,{children:[(0,k.jsx)(c.Td,{fontWeight:700,children:"Input"}),(0,k.jsx)(c.Td,{children:(0,k.jsx)(A,{status:null===N||void 0===N?void 0:N.input.status})}),(0,k.jsx)(c.Td,{children:(0,b.aH)(null===N||void 0===N?void 0:N.input.expected)}),(0,k.jsx)(c.Td,{children:(0,b.aH)(null===N||void 0===N?void 0:N.input.actual)})]})]})]})})}),(0,k.jsx)(x.mz,{children:(0,k.jsx)(y.zx,{onClick:B,children:"Close"})})]})]})]})}function S(n){var i=n.data,e=(0,v.useRef)(null),l=(0,v.useRef)(null);return(0,v.useEffect)((function(){i.length>0&&(0,T.vU)({containerHeight:l.current.getBoundingClientRect().height,containerWidth:l.current.getBoundingClientRect().width,svgTarget:e.current,tooltipTarget:".chart",data:i})}),[i]),(0,k.jsx)(r.kC,{className:"chart",ref:l,width:"100%",children:(0,k.jsx)("svg",{ref:e})})}},4033:function(n,i,e){e.d(i,{$:function(){return d}});var l=e(841),s=e(6417);function d(n){var i=n.name,e=n.base,d=n.input,t=void 0===d?null:d;return(0,s.jsxs)(l.kC,{justifyContent:"space-between",children:[(0,s.jsx)(l.xv,{fontWeight:700,children:i}),(0,s.jsxs)(l.kC,{gap:8,children:[(0,s.jsx)(l.xv,{textAlign:"right",width:"100px",children:e}),t&&(0,s.jsx)(l.xv,{textAlign:"right",width:"100px",children:t})]})]})}}}]);