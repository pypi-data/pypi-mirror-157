min(DALL·E)
===========

|Open In Colab|   |Replicate|   |Join us on Discord|

This is a minimal implementation of Boris Dayma’s `DALL·E
Mini <https://github.com/borisdayma/dalle-mini>`__ in PyTorch. It has
been stripped to the bare essentials necessary for doing inference. The
only third party dependencies are numpy and torch.

It currently takes **7.4 seconds** to generate an image with DALL·E Mega
on a standard GPU runtime in Colab.

The flax model and code for converting it to torch can be found
`here <https://github.com/kuprel/min-dalle-flax>`__.

Install
-------

.. code:: bash

   $ pip install min-dalle

Usage
-----

Python
~~~~~~

Load the model parameters once and reuse the model to generate multiple
images.

.. code:: python

   from min_dalle import MinDalle

   model = MinDalle(is_mega=True, models_root='./pretrained')

The required models will be downloaded to ``models_root`` if they are
not already there. Once everything has finished initializing, call
``generate_image`` with some text and a seed as many times as you want.

.. code:: python

   text = "a comfy chair that looks like an avocado"
   image = model.generate_image(text)
   display(image)

.. figure:: examples/avocado_armchair.png
   :alt: Avocado Armchair

   Avocado Armchair

.. code:: python

   text = "trail cam footage of gollum eating watermelon"
   image = model.generate_image(text, seed=1)
   display(image)

.. figure:: examples/gollum_trailcam.png
   :alt: Gollum Trailcam

   Gollum Trailcam

Command Line
~~~~~~~~~~~~

Use ``image_from_text.py`` to generate images from the command line.

.. code:: bash

   $ python image_from_text.py --text='artificial intelligence' --seed=7

.. figure:: examples/artificial_intelligence.png
   :alt: Artificial Intelligence

   Artificial Intelligence

.. code:: bash

   $ python image_from_text.py --text='court sketch of godzilla on trial' --mega

.. figure:: examples/godzilla_on_trial.png
   :alt: Godzilla Trial

   Godzilla Trial

.. |Open In Colab| image:: https://colab.research.google.com/assets/colab-badge.svg
   :target: https://colab.research.google.com/github/kuprel/min-dalle/blob/main/min_dalle.ipynb
.. |Replicate| image:: https://replicate.com/kuprel/min-dalle/badge
   :target: https://replicate.com/kuprel/min-dalle
.. |Join us on Discord| image:: https://img.shields.io/discord/823813159592001537?color=5865F2&logo=discord&logoColor=white
   :target: https://discord.gg/xBPBXfcFHd
